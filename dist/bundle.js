(()=>{"use strict";const e=["-1","0","1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24"];var t,r;!function(e){e.name="PF2EADJUSTMONSTERLEVEL.name",e.level="PF2EADJUSTMONSTERLEVEL.level",e.str="PF2EADJUSTMONSTERLEVEL.str",e.dex="PF2EADJUSTMONSTERLEVEL.dex",e.con="PF2EADJUSTMONSTERLEVEL.con",e.int="PF2EADJUSTMONSTERLEVEL.int",e.wis="PF2EADJUSTMONSTERLEVEL.wis",e.cha="PF2EADJUSTMONSTERLEVEL.cha",e.hp="PF2EADJUSTMONSTERLEVEL.hp",e.per="PF2EADJUSTMONSTERLEVEL.per",e.ac="PF2EADJUSTMONSTERLEVEL.ac",e.resistWeak="PF2EADJUSTMONSTERLEVEL.resistWeak",e.fort="PF2EADJUSTMONSTERLEVEL.fort",e.ref="PF2EADJUSTMONSTERLEVEL.ref",e.wil="PF2EADJUSTMONSTERLEVEL.wil",e.strikeBonus="PF2EADJUSTMONSTERLEVEL.strikeBonus",e.strikeDamage="PF2EADJUSTMONSTERLEVEL.strikeDamage",e.spellcasting="PF2EADJUSTMONSTERLEVEL.spellcasting",e.spellDC="PF2EADJUSTMONSTERLEVEL.spellDC",e.acrobatics="PF2EADJUSTMONSTERLEVEL.acrobatics",e.arcana="PF2EADJUSTMONSTERLEVEL.arcana",e.athletics="PF2EADJUSTMONSTERLEVEL.athletics",e.crafting="PF2EADJUSTMONSTERLEVEL.crafting",e.deception="PF2EADJUSTMONSTERLEVEL.deception",e.diplomacy="PF2EADJUSTMONSTERLEVEL.diplomacy",e.intimidation="PF2EADJUSTMONSTERLEVEL.intimidation",e.medicine="PF2EADJUSTMONSTERLEVEL.medicine",e.nature="PF2EADJUSTMONSTERLEVEL.nature",e.occultism="PF2EADJUSTMONSTERLEVEL.occultism",e.performance="PF2EADJUSTMONSTERLEVEL.performance",e.religion="PF2EADJUSTMONSTERLEVEL.religion",e.society="PF2EADJUSTMONSTERLEVEL.society",e.stealth="PF2EADJUSTMONSTERLEVEL.stealth",e.survival="PF2EADJUSTMONSTERLEVEL.survival",e.thievery="PF2EADJUSTMONSTERLEVEL.thievery"}(t||(t={})),function(e){e.d4="d4",e.d6="d6",e.d8="d8",e.d10="d10",e.d12="d12"}(r||(r={})),t.acrobatics,t.arcana,t.athletics,t.crafting,t.deception,t.diplomacy,t.intimidation,t.medicine,t.nature,t.occultism,t.performance,t.religion,t.society,t.stealth,t.survival,t.thievery;const m={[t.hp]:"system.attributes.hp.max",[t.ac]:"system.attributes.ac.value"},i={[t.str]:"system.abilities.str.mod",[t.dex]:"system.abilities.dex.mod",[t.con]:"system.abilities.con.mod",[t.int]:"system.abilities.int.mod",[t.wis]:"system.abilities.wis.mod",[t.cha]:"system.abilities.cha.mod"},o={[t.per]:"system.attributes.perception.value",[t.fort]:"system.saves.fortitude.value",[t.ref]:"system.saves.reflex.value",[t.wil]:"system.saves.will.value"};var a,h;!function(e){e.extreme="PF2EADJUSTMONSTERLEVEL.extreme",e.high="PF2EADJUSTMONSTERLEVEL.high",e.moderate="PF2EADJUSTMONSTERLEVEL.moderate",e.low="PF2EADJUSTMONSTERLEVEL.low",e.terrible="PF2EADJUSTMONSTERLEVEL.terrible",e.none="PF2EADJUSTMONSTERLEVEL.none"}(a||(a={})),function(e){e.minimum="PF2EADJUSTMONSTERLEVEL.minimum",e.maximum="PF2EADJUSTMONSTERLEVEL.maximum"}(h||(h={}));const l={abilityScores:{"-1":{[a.extreme]:"4",[a.high]:"3",[a.moderate]:"2",[a.low]:"0"},0:{[a.extreme]:"4",[a.high]:"3",[a.moderate]:"2",[a.low]:"0"},1:{[a.extreme]:"5",[a.high]:"4",[a.moderate]:"3",[a.low]:"1"},2:{[a.extreme]:"5",[a.high]:"4",[a.moderate]:"3",[a.low]:"1"},3:{[a.extreme]:"5",[a.high]:"4",[a.moderate]:"3",[a.low]:"1"},4:{[a.extreme]:"6",[a.high]:"5",[a.moderate]:"3",[a.low]:"2"},5:{[a.extreme]:"6",[a.high]:"5",[a.moderate]:"4",[a.low]:"2"},6:{[a.extreme]:"7",[a.high]:"5",[a.moderate]:"4",[a.low]:"2"},7:{[a.extreme]:"7",[a.high]:"6",[a.moderate]:"4",[a.low]:"2"},8:{[a.extreme]:"7",[a.high]:"6",[a.moderate]:"4",[a.low]:"3"},9:{[a.extreme]:"7",[a.high]:"6",[a.moderate]:"4",[a.low]:"3"},10:{[a.extreme]:"8",[a.high]:"7",[a.moderate]:"5",[a.low]:"3"},11:{[a.extreme]:"8",[a.high]:"7",[a.moderate]:"5",[a.low]:"3"},12:{[a.extreme]:"8",[a.high]:"7",[a.moderate]:"5",[a.low]:"4"},13:{[a.extreme]:"9",[a.high]:"8",[a.moderate]:"5",[a.low]:"4"},14:{[a.extreme]:"9",[a.high]:"8",[a.moderate]:"5",[a.low]:"4"},15:{[a.extreme]:"9",[a.high]:"8",[a.moderate]:"6",[a.low]:"4"},16:{[a.extreme]:"10",[a.high]:"9",[a.moderate]:"6",[a.low]:"5"},17:{[a.extreme]:"10",[a.high]:"9",[a.moderate]:"6",[a.low]:"4"},18:{[a.extreme]:"10",[a.high]:"9",[a.moderate]:"6",[a.low]:"5"},19:{[a.extreme]:"11",[a.high]:"10",[a.moderate]:"6",[a.low]:"5"},20:{[a.extreme]:"11",[a.high]:"10",[a.moderate]:"7",[a.low]:"6"},21:{[a.extreme]:"11",[a.high]:"10",[a.moderate]:"7",[a.low]:"6"},22:{[a.extreme]:"11",[a.high]:"10",[a.moderate]:"8",[a.low]:"6"},23:{[a.extreme]:"11",[a.high]:"10",[a.moderate]:"8",[a.low]:"6"},24:{[a.extreme]:"13",[a.high]:"12",[a.moderate]:"9",[a.low]:"7"}},hitPoints:{"-1":{[a.high]:"9",[a.moderate]:"7",[a.low]:"5"},0:{[a.high]:"18",[a.moderate]:"15",[a.low]:"12"},1:{[a.high]:"25",[a.moderate]:"20",[a.low]:"15"},2:{[a.high]:"38",[a.moderate]:"30",[a.low]:"23"},3:{[a.high]:"56",[a.moderate]:"45",[a.low]:"34"},4:{[a.high]:"75",[a.moderate]:"60",[a.low]:"45"},5:{[a.high]:"94",[a.moderate]:"75",[a.low]:"56"},6:{[a.high]:"119",[a.moderate]:"95",[a.low]:"71"},7:{[a.high]:"144",[a.moderate]:"115",[a.low]:"86"},8:{[a.high]:"169",[a.moderate]:"135",[a.low]:"101"},9:{[a.high]:"194",[a.moderate]:"155",[a.low]:"116"},10:{[a.high]:"219",[a.moderate]:"175",[a.low]:"131"},11:{[a.high]:"244",[a.moderate]:"195",[a.low]:"146"},12:{[a.high]:"269",[a.moderate]:"215",[a.low]:"161"},13:{[a.high]:"294",[a.moderate]:"235",[a.low]:"176"},14:{[a.high]:"319",[a.moderate]:"255",[a.low]:"191"},15:{[a.high]:"344",[a.moderate]:"275",[a.low]:"206"},16:{[a.high]:"369",[a.moderate]:"295",[a.low]:"221"},17:{[a.high]:"394",[a.moderate]:"315",[a.low]:"236"},18:{[a.high]:"419",[a.moderate]:"335",[a.low]:"251"},19:{[a.high]:"444",[a.moderate]:"355",[a.low]:"266"},20:{[a.high]:"469",[a.moderate]:"375",[a.low]:"281"},21:{[a.high]:"500",[a.moderate]:"400",[a.low]:"300"},22:{[a.high]:"538",[a.moderate]:"430",[a.low]:"323"},23:{[a.high]:"575",[a.moderate]:"460",[a.low]:"345"},24:{[a.high]:"625",[a.moderate]:"500",[a.low]:"375"}},perceptionSaves:{"-1":{[a.extreme]:"9",[a.high]:"8",[a.moderate]:"5",[a.low]:"2",[a.terrible]:"0"},0:{[a.extreme]:"10",[a.high]:"9",[a.moderate]:"6",[a.low]:"3",[a.terrible]:"1"},1:{[a.extreme]:"11",[a.high]:"10",[a.moderate]:"7",[a.low]:"4",[a.terrible]:"2"},2:{[a.extreme]:"12",[a.high]:"11",[a.moderate]:"8",[a.low]:"5",[a.terrible]:"3"},3:{[a.extreme]:"14",[a.high]:"12",[a.moderate]:"9",[a.low]:"6",[a.terrible]:"4"},4:{[a.extreme]:"15",[a.high]:"14",[a.moderate]:"11",[a.low]:"8",[a.terrible]:"6"},5:{[a.extreme]:"17",[a.high]:"15",[a.moderate]:"12",[a.low]:"9",[a.terrible]:"7"},6:{[a.extreme]:"18",[a.high]:"17",[a.moderate]:"14",[a.low]:"11",[a.terrible]:"8"},7:{[a.extreme]:"20",[a.high]:"18",[a.moderate]:"15",[a.low]:"12",[a.terrible]:"10"},8:{[a.extreme]:"21",[a.high]:"19",[a.moderate]:"16",[a.low]:"13",[a.terrible]:"11"},9:{[a.extreme]:"23",[a.high]:"21",[a.moderate]:"18",[a.low]:"15",[a.terrible]:"12"},10:{[a.extreme]:"24",[a.high]:"22",[a.moderate]:"19",[a.low]:"16",[a.terrible]:"14"},11:{[a.extreme]:"26",[a.high]:"24",[a.moderate]:"21",[a.low]:"18",[a.terrible]:"15"},12:{[a.extreme]:"27",[a.high]:"25",[a.moderate]:"22",[a.low]:"19",[a.terrible]:"16"},13:{[a.extreme]:"29",[a.high]:"26",[a.moderate]:"23",[a.low]:"20",[a.terrible]:"18"},14:{[a.extreme]:"30",[a.high]:"28",[a.moderate]:"25",[a.low]:"22",[a.terrible]:"19"},15:{[a.extreme]:"32",[a.high]:"29",[a.moderate]:"26",[a.low]:"23",[a.terrible]:"20"},16:{[a.extreme]:"33",[a.high]:"30",[a.moderate]:"28",[a.low]:"25",[a.terrible]:"22"},17:{[a.extreme]:"35",[a.high]:"32",[a.moderate]:"29",[a.low]:"26",[a.terrible]:"23"},18:{[a.extreme]:"36",[a.high]:"33",[a.moderate]:"30",[a.low]:"27",[a.terrible]:"24"},19:{[a.extreme]:"38",[a.high]:"35",[a.moderate]:"32",[a.low]:"29",[a.terrible]:"26"},20:{[a.extreme]:"39",[a.high]:"36",[a.moderate]:"33",[a.low]:"30",[a.terrible]:"27"},21:{[a.extreme]:"41",[a.high]:"38",[a.moderate]:"35",[a.low]:"32",[a.terrible]:"28"},22:{[a.extreme]:"43",[a.high]:"39",[a.moderate]:"36",[a.low]:"33",[a.terrible]:"30"},23:{[a.extreme]:"44",[a.high]:"40",[a.moderate]:"37",[a.low]:"34",[a.terrible]:"31"},24:{[a.extreme]:"46",[a.high]:"42",[a.moderate]:"38",[a.low]:"36",[a.terrible]:"32"}},armorClass:{"-1":{[a.extreme]:"18",[a.high]:"15",[a.moderate]:"14",[a.low]:"12"},0:{[a.extreme]:"19",[a.high]:"16",[a.moderate]:"15",[a.low]:"13"},1:{[a.extreme]:"19",[a.high]:"16",[a.moderate]:"15",[a.low]:"13"},2:{[a.extreme]:"21",[a.high]:"18",[a.moderate]:"17",[a.low]:"15"},3:{[a.extreme]:"22",[a.high]:"19",[a.moderate]:"18",[a.low]:"16"},4:{[a.extreme]:"24",[a.high]:"21",[a.moderate]:"20",[a.low]:"18"},5:{[a.extreme]:"25",[a.high]:"22",[a.moderate]:"21",[a.low]:"19"},6:{[a.extreme]:"27",[a.high]:"24",[a.moderate]:"23",[a.low]:"21"},7:{[a.extreme]:"28",[a.high]:"25",[a.moderate]:"24",[a.low]:"22"},8:{[a.extreme]:"30",[a.high]:"27",[a.moderate]:"26",[a.low]:"24"},9:{[a.extreme]:"31",[a.high]:"28",[a.moderate]:"27",[a.low]:"25"},10:{[a.extreme]:"33",[a.high]:"30",[a.moderate]:"29",[a.low]:"27"},11:{[a.extreme]:"34",[a.high]:"31",[a.moderate]:"30",[a.low]:"28"},12:{[a.extreme]:"36",[a.high]:"33",[a.moderate]:"32",[a.low]:"30"},13:{[a.extreme]:"37",[a.high]:"34",[a.moderate]:"33",[a.low]:"31"},14:{[a.extreme]:"39",[a.high]:"36",[a.moderate]:"35",[a.low]:"33"},15:{[a.extreme]:"40",[a.high]:"37",[a.moderate]:"36",[a.low]:"34"},16:{[a.extreme]:"42",[a.high]:"39",[a.moderate]:"38",[a.low]:"36"},17:{[a.extreme]:"43",[a.high]:"40",[a.moderate]:"39",[a.low]:"37"},18:{[a.extreme]:"45",[a.high]:"42",[a.moderate]:"41",[a.low]:"39"},19:{[a.extreme]:"46",[a.high]:"43",[a.moderate]:"42",[a.low]:"40"},20:{[a.extreme]:"48",[a.high]:"45",[a.moderate]:"44",[a.low]:"42"},21:{[a.extreme]:"49",[a.high]:"46",[a.moderate]:"45",[a.low]:"43"},22:{[a.extreme]:"51",[a.high]:"48",[a.moderate]:"47",[a.low]:"45"},23:{[a.extreme]:"52",[a.high]:"49",[a.moderate]:"48",[a.low]:"46"},24:{[a.extreme]:"54",[a.high]:"51",[a.moderate]:"50",[a.low]:"48"}},strikeBonus:{"-1":{[a.extreme]:"10",[a.high]:"8",[a.moderate]:"6",[a.low]:"4"},0:{[a.extreme]:"10",[a.high]:"8",[a.moderate]:"6",[a.low]:"4"},1:{[a.extreme]:"11",[a.high]:"9",[a.moderate]:"7",[a.low]:"5"},2:{[a.extreme]:"13",[a.high]:"11",[a.moderate]:"9",[a.low]:"7"},3:{[a.extreme]:"14",[a.high]:"12",[a.moderate]:"10",[a.low]:"8"},4:{[a.extreme]:"16",[a.high]:"14",[a.moderate]:"12",[a.low]:"9"},5:{[a.extreme]:"17",[a.high]:"15",[a.moderate]:"13",[a.low]:"11"},6:{[a.extreme]:"19",[a.high]:"17",[a.moderate]:"15",[a.low]:"12"},7:{[a.extreme]:"20",[a.high]:"18",[a.moderate]:"16",[a.low]:"13"},8:{[a.extreme]:"22",[a.high]:"20",[a.moderate]:"18",[a.low]:"15"},9:{[a.extreme]:"23",[a.high]:"21",[a.moderate]:"19",[a.low]:"16"},10:{[a.extreme]:"25",[a.high]:"23",[a.moderate]:"21",[a.low]:"17"},11:{[a.extreme]:"27",[a.high]:"24",[a.moderate]:"22",[a.low]:"19"},12:{[a.extreme]:"28",[a.high]:"26",[a.moderate]:"24",[a.low]:"20"},13:{[a.extreme]:"29",[a.high]:"27",[a.moderate]:"25",[a.low]:"21"},14:{[a.extreme]:"31",[a.high]:"29",[a.moderate]:"27",[a.low]:"23"},15:{[a.extreme]:"32",[a.high]:"30",[a.moderate]:"28",[a.low]:"24"},16:{[a.extreme]:"34",[a.high]:"32",[a.moderate]:"30",[a.low]:"25"},17:{[a.extreme]:"35",[a.high]:"33",[a.moderate]:"31",[a.low]:"27"},18:{[a.extreme]:"37",[a.high]:"35",[a.moderate]:"33",[a.low]:"28"},19:{[a.extreme]:"38",[a.high]:"36",[a.moderate]:"34",[a.low]:"29"},20:{[a.extreme]:"40",[a.high]:"38",[a.moderate]:"36",[a.low]:"31"},21:{[a.extreme]:"41",[a.high]:"39",[a.moderate]:"37",[a.low]:"32"},22:{[a.extreme]:"43",[a.high]:"41",[a.moderate]:"39",[a.low]:"33"},23:{[a.extreme]:"44",[a.high]:"42",[a.moderate]:"40",[a.low]:"35"},24:{[a.extreme]:"46",[a.high]:"44",[a.moderate]:"42",[a.low]:"36"}},strikeDamage:{"-1":{[a.extreme]:"4",[a.high]:"3",[a.moderate]:"3",[a.low]:"2"},0:{[a.extreme]:"6",[a.high]:"5",[a.moderate]:"4",[a.low]:"3"},1:{[a.extreme]:"8",[a.high]:"6",[a.moderate]:"5",[a.low]:"4"},2:{[a.extreme]:"11",[a.high]:"9",[a.moderate]:"8",[a.low]:"6"},3:{[a.extreme]:"15",[a.high]:"12",[a.moderate]:"10",[a.low]:"8"},4:{[a.extreme]:"18",[a.high]:"14",[a.moderate]:"12",[a.low]:"9"},5:{[a.extreme]:"20",[a.high]:"16",[a.moderate]:"13",[a.low]:"11"},6:{[a.extreme]:"23",[a.high]:"18",[a.moderate]:"15",[a.low]:"12"},7:{[a.extreme]:"25",[a.high]:"20",[a.moderate]:"17",[a.low]:"13"},8:{[a.extreme]:"28",[a.high]:"22",[a.moderate]:"18",[a.low]:"15"},9:{[a.extreme]:"30",[a.high]:"24",[a.moderate]:"20",[a.low]:"16"},10:{[a.extreme]:"33",[a.high]:"26",[a.moderate]:"22",[a.low]:"17"},11:{[a.extreme]:"35",[a.high]:"28",[a.moderate]:"23",[a.low]:"19"},12:{[a.extreme]:"38",[a.high]:"30",[a.moderate]:"25",[a.low]:"20"},13:{[a.extreme]:"40",[a.high]:"32",[a.moderate]:"27",[a.low]:"21"},14:{[a.extreme]:"43",[a.high]:"34",[a.moderate]:"28",[a.low]:"23"},15:{[a.extreme]:"45",[a.high]:"36",[a.moderate]:"30",[a.low]:"24"},16:{[a.extreme]:"48",[a.high]:"37",[a.moderate]:"31",[a.low]:"25"},17:{[a.extreme]:"50",[a.high]:"38",[a.moderate]:"32",[a.low]:"26"},18:{[a.extreme]:"53",[a.high]:"40",[a.moderate]:"33",[a.low]:"27"},19:{[a.extreme]:"55",[a.high]:"42",[a.moderate]:"35",[a.low]:"28"},20:{[a.extreme]:"58",[a.high]:"44",[a.moderate]:"37",[a.low]:"29"},21:{[a.extreme]:"60",[a.high]:"46",[a.moderate]:"38",[a.low]:"31"},22:{[a.extreme]:"63",[a.high]:"48",[a.moderate]:"40",[a.low]:"32"},23:{[a.extreme]:"65",[a.high]:"50",[a.moderate]:"42",[a.low]:"33"},24:{[a.extreme]:"68",[a.high]:"52",[a.moderate]:"44",[a.low]:"35"}},strikeDamageRoll:{"-1":{[a.extreme]:"1d6+1",[a.high]:"1d4+1",[a.moderate]:"1d4",[a.low]:"1d4"},0:{[a.extreme]:"1d6+3",[a.high]:"1d6+2",[a.moderate]:"1d4+2",[a.low]:"1d4+1"},1:{[a.extreme]:"1d8+4",[a.high]:"1d6+3",[a.moderate]:"1d6+2",[a.low]:"1d4+2"},2:{[a.extreme]:"1d12+4",[a.high]:"1d10+4",[a.moderate]:"1d8+4",[a.low]:"1d6+3"},3:{[a.extreme]:"1d12+8",[a.high]:"1d10+6",[a.moderate]:"1d8+6",[a.low]:"1d6+5"},4:{[a.extreme]:"2d10+7",[a.high]:"2d8+5",[a.moderate]:"2d6+5",[a.low]:"2d4+4"},5:{[a.extreme]:"2d12+7",[a.high]:"2d8+7",[a.moderate]:"2d6+6",[a.low]:"2d4+6"},6:{[a.extreme]:"2d12+10",[a.high]:"2d8+9",[a.moderate]:"2d6+8",[a.low]:"2d4+7"},7:{[a.extreme]:"2d12+12",[a.high]:"2d10+9",[a.moderate]:"2d8+8",[a.low]:"2d6+6"},8:{[a.extreme]:"2d12+15",[a.high]:"2d10+11",[a.moderate]:"2d8+9",[a.low]:"2d6+8"},9:{[a.extreme]:"2d12+17",[a.high]:"2d10+13",[a.moderate]:"2d8+11",[a.low]:"2d6+9"},10:{[a.extreme]:"2d12+20",[a.high]:"2d12+13",[a.moderate]:"2d10+11",[a.low]:"2d6+10"},11:{[a.extreme]:"2d12+22",[a.high]:"2d12+15",[a.moderate]:"2d10+12",[a.low]:"2d8+10"},12:{[a.extreme]:"3d12+19",[a.high]:"3d10+14",[a.moderate]:"3d8+12",[a.low]:"3d6+10"},13:{[a.extreme]:"3d12+21",[a.high]:"3d10+16",[a.moderate]:"3d8+14",[a.low]:"3d6+11"},14:{[a.extreme]:"3d12+24",[a.high]:"3d10+18",[a.moderate]:"3d8+15",[a.low]:"3d6+13"},15:{[a.extreme]:"3d12+26",[a.high]:"3d12+17",[a.moderate]:"3d10+14",[a.low]:"3d6+14"},16:{[a.extreme]:"3d12+29",[a.high]:"3d12+18",[a.moderate]:"3d10+15",[a.low]:"3d6+15"},17:{[a.extreme]:"3d12+31",[a.high]:"3d12+19",[a.moderate]:"3d10+16",[a.low]:"3d6+16"},18:{[a.extreme]:"3d12+34",[a.high]:"3d12+20",[a.moderate]:"3d10+17",[a.low]:"3d6+17"},19:{[a.extreme]:"4d12+29",[a.high]:"4d10+20",[a.moderate]:"4d8+17",[a.low]:"4d6+14"},20:{[a.extreme]:"4d12+32",[a.high]:"4d10+22",[a.moderate]:"4d8+19",[a.low]:"4d6+15"},21:{[a.extreme]:"4d12+34",[a.high]:"4d10+24",[a.moderate]:"4d8+20",[a.low]:"4d6+17"},22:{[a.extreme]:"4d12+37",[a.high]:"4d10+26",[a.moderate]:"4d8+22",[a.low]:"4d6+18"},23:{[a.extreme]:"4d12+39",[a.high]:"4d12+24",[a.moderate]:"4d10+20",[a.low]:"4d6+19"},24:{[a.extreme]:"4d12+42",[a.high]:"4d12+26",[a.moderate]:"4d10+22",[a.low]:"4d6+21"}},spellcasting:{"-1":{[a.extreme]:"11",[a.high]:"8",[a.moderate]:"5"},0:{[a.extreme]:"11",[a.high]:"8",[a.moderate]:"5"},1:{[a.extreme]:"12",[a.high]:"9",[a.moderate]:"6"},2:{[a.extreme]:"14",[a.high]:"10",[a.moderate]:"7"},3:{[a.extreme]:"15",[a.high]:"12",[a.moderate]:"9"},4:{[a.extreme]:"17",[a.high]:"13",[a.moderate]:"10"},5:{[a.extreme]:"18",[a.high]:"14",[a.moderate]:"11"},6:{[a.extreme]:"19",[a.high]:"16",[a.moderate]:"13"},7:{[a.extreme]:"21",[a.high]:"17",[a.moderate]:"14"},8:{[a.extreme]:"22",[a.high]:"18",[a.moderate]:"15"},9:{[a.extreme]:"24",[a.high]:"20",[a.moderate]:"17"},10:{[a.extreme]:"25",[a.high]:"21",[a.moderate]:"18"},11:{[a.extreme]:"26",[a.high]:"22",[a.moderate]:"19"},12:{[a.extreme]:"28",[a.high]:"24",[a.moderate]:"21"},13:{[a.extreme]:"29",[a.high]:"25",[a.moderate]:"22"},14:{[a.extreme]:"31",[a.high]:"26",[a.moderate]:"23"},15:{[a.extreme]:"32",[a.high]:"28",[a.moderate]:"25"},16:{[a.extreme]:"33",[a.high]:"29",[a.moderate]:"26"},17:{[a.extreme]:"35",[a.high]:"30",[a.moderate]:"27"},18:{[a.extreme]:"36",[a.high]:"32",[a.moderate]:"29"},19:{[a.extreme]:"38",[a.high]:"33",[a.moderate]:"30"},20:{[a.extreme]:"39",[a.high]:"34",[a.moderate]:"31"},21:{[a.extreme]:"40",[a.high]:"36",[a.moderate]:"33"},22:{[a.extreme]:"42",[a.high]:"37",[a.moderate]:"34"},23:{[a.extreme]:"43",[a.high]:"38",[a.moderate]:"35"},24:{[a.extreme]:"44",[a.high]:"40",[a.moderate]:"37"}},spellDC:{"-1":{[a.extreme]:"19",[a.high]:"16",[a.moderate]:"13"},0:{[a.extreme]:"19",[a.high]:"16",[a.moderate]:"13"},1:{[a.extreme]:"20",[a.high]:"17",[a.moderate]:"14"},2:{[a.extreme]:"22",[a.high]:"18",[a.moderate]:"15"},3:{[a.extreme]:"23",[a.high]:"20",[a.moderate]:"17"},4:{[a.extreme]:"25",[a.high]:"21",[a.moderate]:"18"},5:{[a.extreme]:"26",[a.high]:"22",[a.moderate]:"19"},6:{[a.extreme]:"27",[a.high]:"24",[a.moderate]:"21"},7:{[a.extreme]:"29",[a.high]:"25",[a.moderate]:"22"},8:{[a.extreme]:"30",[a.high]:"26",[a.moderate]:"23"},9:{[a.extreme]:"32",[a.high]:"28",[a.moderate]:"25"},10:{[a.extreme]:"33",[a.high]:"29",[a.moderate]:"26"},11:{[a.extreme]:"34",[a.high]:"30",[a.moderate]:"27"},12:{[a.extreme]:"36",[a.high]:"32",[a.moderate]:"29"},13:{[a.extreme]:"37",[a.high]:"33",[a.moderate]:"30"},14:{[a.extreme]:"39",[a.high]:"34",[a.moderate]:"31"},15:{[a.extreme]:"40",[a.high]:"36",[a.moderate]:"33"},16:{[a.extreme]:"41",[a.high]:"37",[a.moderate]:"34"},17:{[a.extreme]:"43",[a.high]:"38",[a.moderate]:"35"},18:{[a.extreme]:"44",[a.high]:"40",[a.moderate]:"37"},19:{[a.extreme]:"46",[a.high]:"41",[a.moderate]:"38"},20:{[a.extreme]:"47",[a.high]:"42",[a.moderate]:"39"},21:{[a.extreme]:"48",[a.high]:"44",[a.moderate]:"41"},22:{[a.extreme]:"50",[a.high]:"45",[a.moderate]:"42"},23:{[a.extreme]:"51",[a.high]:"46",[a.moderate]:"43"},24:{[a.extreme]:"52",[a.high]:"48",[a.moderate]:"45"}},skills:{"-1":{[a.extreme]:"8",[a.high]:"5",[a.moderate]:"4",[a.low]:"2"},0:{[a.extreme]:"9",[a.high]:"6",[a.moderate]:"5",[a.low]:"3"},1:{[a.extreme]:"10",[a.high]:"7",[a.moderate]:"6",[a.low]:"4"},2:{[a.extreme]:"11",[a.high]:"8",[a.moderate]:"7",[a.low]:"5"},3:{[a.extreme]:"13",[a.high]:"10",[a.moderate]:"9",[a.low]:"6"},4:{[a.extreme]:"15",[a.high]:"12",[a.moderate]:"10",[a.low]:"8"},5:{[a.extreme]:"16",[a.high]:"13",[a.moderate]:"12",[a.low]:"9"},6:{[a.extreme]:"18",[a.high]:"15",[a.moderate]:"13",[a.low]:"10"},7:{[a.extreme]:"20",[a.high]:"17",[a.moderate]:"15",[a.low]:"12"},8:{[a.extreme]:"21",[a.high]:"18",[a.moderate]:"16",[a.low]:"13"},9:{[a.extreme]:"23",[a.high]:"20",[a.moderate]:"18",[a.low]:"14"},10:{[a.extreme]:"25",[a.high]:"22",[a.moderate]:"19",[a.low]:"16"},11:{[a.extreme]:"26",[a.high]:"23",[a.moderate]:"21",[a.low]:"18"},12:{[a.extreme]:"28",[a.high]:"25",[a.moderate]:"22",[a.low]:"19"},13:{[a.extreme]:"30",[a.high]:"27",[a.moderate]:"24",[a.low]:"21"},14:{[a.extreme]:"31",[a.high]:"28",[a.moderate]:"25",[a.low]:"22"},15:{[a.extreme]:"33",[a.high]:"30",[a.moderate]:"27",[a.low]:"23"},16:{[a.extreme]:"35",[a.high]:"32",[a.moderate]:"28",[a.low]:"25"},17:{[a.extreme]:"36",[a.high]:"33",[a.moderate]:"30",[a.low]:"26"},18:{[a.extreme]:"38",[a.high]:"35",[a.moderate]:"31",[a.low]:"28"},19:{[a.extreme]:"40",[a.high]:"37",[a.moderate]:"33",[a.low]:"29"},20:{[a.extreme]:"41",[a.high]:"38",[a.moderate]:"34",[a.low]:"30"},21:{[a.extreme]:"43",[a.high]:"40",[a.moderate]:"36",[a.low]:"31"},22:{[a.extreme]:"45",[a.high]:"42",[a.moderate]:"37",[a.low]:"32"},23:{[a.extreme]:"46",[a.high]:"43",[a.moderate]:"38",[a.low]:"34"},24:{[a.extreme]:"48",[a.high]:"45",[a.moderate]:"40",[a.low]:"36"}},resistWeak:{"-1":{[h.minimum]:"1",[h.maximum]:"1"},0:{[h.minimum]:"1",[h.maximum]:"3"},1:{[h.minimum]:"2",[h.maximum]:"3"},2:{[h.minimum]:"2",[h.maximum]:"5"},3:{[h.minimum]:"3",[h.maximum]:"6"},4:{[h.minimum]:"4",[h.maximum]:"7"},5:{[h.minimum]:"4",[h.maximum]:"8"},6:{[h.minimum]:"5",[h.maximum]:"9"},7:{[h.minimum]:"5",[h.maximum]:"10"},8:{[h.minimum]:"6",[h.maximum]:"11"},9:{[h.minimum]:"6",[h.maximum]:"12"},10:{[h.minimum]:"7",[h.maximum]:"13"},11:{[h.minimum]:"7",[h.maximum]:"14"},12:{[h.minimum]:"8",[h.maximum]:"15"},13:{[h.minimum]:"8",[h.maximum]:"16"},14:{[h.minimum]:"9",[h.maximum]:"17"},15:{[h.minimum]:"9",[h.maximum]:"18"},16:{[h.minimum]:"9",[h.maximum]:"19"},17:{[h.minimum]:"10",[h.maximum]:"19"},18:{[h.minimum]:"10",[h.maximum]:"20"},19:{[h.minimum]:"11",[h.maximum]:"21"},20:{[h.minimum]:"11",[h.maximum]:"22"},21:{[h.minimum]:"12",[h.maximum]:"23"},22:{[h.minimum]:"12",[h.maximum]:"24"},23:{[h.minimum]:"13",[h.maximum]:"25"},24:{[h.minimum]:"13",[h.maximum]:"26"}}},d={[t.str]:l.abilityScores,[t.dex]:l.abilityScores,[t.con]:l.abilityScores,[t.int]:l.abilityScores,[t.wis]:l.abilityScores,[t.cha]:l.abilityScores,[t.hp]:l.hitPoints,[t.per]:l.perceptionSaves,[t.ac]:l.armorClass,[t.resistWeak]:l.resistWeak,[t.fort]:l.perceptionSaves,[t.ref]:l.perceptionSaves,[t.wil]:l.perceptionSaves,[t.strikeBonus]:l.strikeBonus,[t.strikeDamage]:l.strikeDamage,[t.spellcasting]:l.spellcasting,[t.spellDC]:l.spellDC,[t.acrobatics]:l.skills,[t.arcana]:l.skills,[t.athletics]:l.skills,[t.crafting]:l.skills,[t.deception]:l.skills,[t.diplomacy]:l.skills,[t.intimidation]:l.skills,[t.medicine]:l.skills,[t.nature]:l.skills,[t.occultism]:l.skills,[t.performance]:l.skills,[t.religion]:l.skills,[t.society]:l.skills,[t.stealth]:l.skills,[t.survival]:l.skills,[t.thievery]:l.skills},s={[r.d4]:2.5,[r.d6]:3.5,[r.d8]:4.5,[r.d10]:5.5,[r.d12]:6.5};class g{constructor(e){this.adjustments=[],this.displayName=e}}class n extends FormApplication{constructor(){super(...arguments),this.actor=this.object,this.level="-1",this.DataToModify=[],this.indexPattern=/\.(\d+)\./}static get defaultOptions(){return mergeObject(super.defaultOptions,{classes:["form"],popOut:!0,template:"modules/pf2e-adjust-monster-level/forms/adjustMonsterLevelForm.html",id:"adjustMonsterLevelForm",title:"Adjust Level Form",height:833,width:400})}async _updateObject(e,r){if(r){let e=this.actor.system.details.level.value;this.level=r[t.level];let m=[],i={targetDocument:this.actor,data:{name:r[t.name]?r[t.name]:this.actor.name,"system.details.level.value":parseInt(this.level)}};m.push(i);for(const r of this.DataToModify)for(const i of r.adjustments)if("function"==typeof i.targetDocument.update){let r=m.find((e=>e.targetDocument==i.targetDocument));r||(r={targetDocument:i.targetDocument,data:{}},m.push(r)),i.targetAttribute.match(this.indexPattern)||(i.statistic==t.strikeDamage?this.mergeStrikeDamage(r,i,this.level>e):this.mergeSimpleAdjustment(r,i))}for(const e of m)await e.targetDocument.update(e.data);await this.actor.update(this.applyHitPoints())}}mergeStrikeDamage(e,t,r){let m=d[t.statistic][this.level],i=n.getNumericValue(t.normalizedValue,m),o={},a=n.getChildField(t.targetDocument,t.targetAttribute);for(let[e,m]of Object.entries(a)){let a=m.damage,h=t.metaData[e],l=h.totalFraction*i,d="";if(h.flatFraction>0){let e=Math.round(l*h.flatFraction);d+=`+${e}`,l-=e}d=n.getClosestDieRoll(l,h.dieSize,r)+d,o[`${t.targetAttribute}.${e}.damage`]=d,console.log(`${a} -> ${d}`)}e.data=mergeObject(e.data,o)}mergeSimpleAdjustment(e,t){let r=d[t.statistic][this.level],m={[t.targetAttribute]:n.getNumericValue(t.normalizedValue,r)};e.data=mergeObject(e.data,m)}mergeIndexedAdjustment(e,t,r){let m=d[t.statistic][this.level],i=t.targetAttribute.indexOf(r),o=t.targetAttribute.substring(i+r.length+1);t.targetAttribute=t.targetAttribute.substring(0,i+r.length),console.log(t.targetAttribute);let a=n.getChildField(t.targetDocument,t.targetAttribute);console.log(a);let h=JSON.parse(JSON.stringify(a));mergeObject(h,{[o]:n.getNumericValue(t.normalizedValue,m)});let l={[t.targetAttribute]:h};e.data=mergeObject(e.data,l)}static getClosestDieRoll(e,t,m){let i=[r.d4,r.d6,r.d8,r.d10,r.d12];const o=i.indexOf(t);m&&o>0?i.splice(0,o):!m&&o<i.length-1&&i.splice(i.indexOf(t)+1);let a=Math.round(e/s[t]),h=t,l=Math.abs(a*s[t]-e);for(const t of i){const r=s[t];let m=Math.round(e/r),i=Math.abs(m*r-e);i<l&&(a=m,h=t,l=i)}return`${a}${h}`}static getNumericValue(e,t){let r=[h.minimum,h.maximum,a.terrible,a.low,a.moderate,a.high,a.extreme];r=r.filter((e=>e in t));for(let m=0;m<r.length-1;m++){if(e<m+1&&0!=m)continue;if(e>m+2&&m!=r.length-1)continue;const i=e-(m+1);let o=parseInt(t[r[m]]),a=parseInt(t[r[m+1]]);return Math.round(i*(a-o)+o)}return 0}applyHitPoints(){return{"system.attributes.hp.value":this.actor.system.attributes.hp.max}}getData(){this.level=this.actor.system.details.level.value.toString();const r={[t.name]:this.actor.name,[t.level]:this.level};this.pushActorCategory("Defenses",m),this.pushActorCategory("Ability Modifiers",i),this.pushActorCategory("Perception and Saves",o),this.actor;let a=new g("Skills");this.DataToModify.push(a);for(const[e,r]of this.actor.items.entries())if("lore"==r.type&&null!=r.name){let e="PF2EADJUSTMONSTERLEVEL."+r.name.toLowerCase(),t=this.getItemAdjustment(e,r,"system.mod.value");t&&a.adjustments.push(t)}else if("spellcastingEntry"==r.type&&null!=r.name){let e=this.getItemAdjustment(t.spellcasting,r,"system.spelldc.value");if(e){let t=JSON.parse(JSON.stringify(e));t.targetAttribute="system.spelldc.dc";let m=new g(r.name);m.adjustments.push(e),m.adjustments.push(t),this.DataToModify.push(m)}}else if("melee"==r.type&&null!=r.name){let e=this.getItemAdjustment(t.strikeBonus,r,"system.bonus.value"),m=this.getItemAdjustment(t.strikeDamage,r,"system.damageRolls"),i=new g(r.name+" Strike");e&&i.adjustments.push(e),m&&i.adjustments.push(m),i.adjustments.length>0&&this.DataToModify.push(i)}return Handlebars.registerHelper("json",(function(e){return JSON.stringify(e)})),{Levels:e,Current:r,ToModify:JSON.parse(JSON.stringify(this.DataToModify))}}pushActorCategory(e,t){let r=new g(e);for(const[e,m]of Object.entries(t)){let t=this.getActorFieldAdjustment(e,m);t&&r.adjustments.push(t)}this.DataToModify.push(r)}getActorFieldAdjustment(e,t){const r=d[e][this.level];let m=n.getChildField(this.actor,t),i=n.getNormalizedValue(m,r,1);return i.value>-9999?{targetDocument:this.actor,targetAttribute:t,normalizedValue:i.value,displayValue:i.display,statistic:e}:null}getResistWeakAdjustment(e,r){const m=d[t.resistWeak][this.level];let i=e.value,o=n.getNormalizedValue(i,m,1);return{targetDocument:this.actor,targetAttribute:r,statistic:t.resistWeak,normalizedValue:o.value,displayValue:o.display,displayName:e.type}}getItemAdjustment(e,r,m){const i=d[e][this.level];let o=null,a=0;if("lore"==r.type||"spellcastingEntry"==r.type||"melee"==r.type&&e==t.strikeBonus)a=n.getChildField(r,m);else{if("melee"!=r.type||e!=t.strikeDamage)return null;{let e=0;o={};for(let[t,m]of Object.entries(r.system.damageRolls)){let r=n.getDamageRollValues(m.damage);e+=r.total,o[t]={totalFraction:r.total,flatFraction:r.flatFraction,dieSize:r.dieSize}}a=Math.ceil(e);for(const[e,t]of Object.entries(o))t.totalFraction=t.totalFraction/a}}let h=n.getNormalizedValue(a,i,1);return h.value>-9999?{targetDocument:r,targetAttribute:m,statistic:e,normalizedValue:h.value,displayValue:h.display,metaData:o}:null}static getNormalizedValue(e,t,r=-9999){let m=[h.minimum,h.maximum,a.terrible,a.low,a.moderate,a.high,a.extreme];if(m=m.filter((e=>e in t)),-9999===r&&(r=parseInt(t[m[0]])),e<r)return{value:-9999,display:""};for(let r=0;r<m.length-1;r++){const i=parseInt(t[m[r]]),o=parseInt(t[m[r+1]]);if(e>=i&&e<o||0==r&&e<i||r==m.length-2&&e>=o){let t=(e-i)/(o-i);t=Math.round(10*t)/10;let a=game.i18n.localize(m[r]);return 0!=t&&1!=t&&(t>0&&(a+="+"),a+=t.toFixed(1)),(t<0||t>1)&&(a+=" ⚠️"),{value:t+r+1,display:a}}}return{value:-9999,display:""}}static getDamageRollValues(e){let t=0,r=0;const m=e.indexOf("+");m>=0&&(r=parseInt(e.substring(m+1)),t+=r,e=e.substring(0,m));const i=(e=e.trim()).indexOf("d");let o="";if(i>=0){let r=e.substring(0,i);o=e.substring(i),t+=parseInt(r)*s[o]}return{total:t,dieSize:o,flatFraction:r/t}}static getChildField(e,t){let r=e,m=t.split(".");for(;m.length>0;)r=r[m[0]],m.splice(0,1);return r}}Hooks.on("init",(async function(){await game.settings.register("foundryvtt-pf2e-adjust-monster-level","roadmaps",{scope:"world",config:!1,type:Object,default:{}})})),Hooks.on("renderActorSheet",(async function(e,t){let r=e.object;if("npc"!==r?.type)return;if(!r.canUserModify(game.user,"update"))return;let m=t.find(".adjustment-select"),i=$('<a class="adjustment trait" style>Adjust Level</a>');i.on("click",(()=>{new n(r).render(!0)})),m.after(i)}))})();