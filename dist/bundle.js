(()=>{"use strict";const e="pf2e-adjust-monster-level",t="testMode",r=["-1","0","1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24"];var m,i;!function(e){e.name="PF2EADJUSTMONSTERLEVEL.name",e.level="PF2EADJUSTMONSTERLEVEL.level",e.str="PF2EADJUSTMONSTERLEVEL.str",e.dex="PF2EADJUSTMONSTERLEVEL.dex",e.con="PF2EADJUSTMONSTERLEVEL.con",e.int="PF2EADJUSTMONSTERLEVEL.int",e.wis="PF2EADJUSTMONSTERLEVEL.wis",e.cha="PF2EADJUSTMONSTERLEVEL.cha",e.hp="PF2EADJUSTMONSTERLEVEL.hp",e.per="PF2EADJUSTMONSTERLEVEL.per",e.ac="PF2EADJUSTMONSTERLEVEL.ac",e.resistWeak="PF2EADJUSTMONSTERLEVEL.resistWeak",e.fort="PF2EADJUSTMONSTERLEVEL.fort",e.ref="PF2EADJUSTMONSTERLEVEL.ref",e.wil="PF2EADJUSTMONSTERLEVEL.wil",e.strikeBonus="PF2EADJUSTMONSTERLEVEL.strikeBonus",e.strikeDamage="PF2EADJUSTMONSTERLEVEL.strikeDamage",e.spellcasting="PF2EADJUSTMONSTERLEVEL.spellcasting",e.spellDC="PF2EADJUSTMONSTERLEVEL.spellDC",e.acrobatics="PF2EADJUSTMONSTERLEVEL.acrobatics",e.arcana="PF2EADJUSTMONSTERLEVEL.arcana",e.athletics="PF2EADJUSTMONSTERLEVEL.athletics",e.crafting="PF2EADJUSTMONSTERLEVEL.crafting",e.deception="PF2EADJUSTMONSTERLEVEL.deception",e.diplomacy="PF2EADJUSTMONSTERLEVEL.diplomacy",e.intimidation="PF2EADJUSTMONSTERLEVEL.intimidation",e.medicine="PF2EADJUSTMONSTERLEVEL.medicine",e.nature="PF2EADJUSTMONSTERLEVEL.nature",e.occultism="PF2EADJUSTMONSTERLEVEL.occultism",e.performance="PF2EADJUSTMONSTERLEVEL.performance",e.religion="PF2EADJUSTMONSTERLEVEL.religion",e.society="PF2EADJUSTMONSTERLEVEL.society",e.stealth="PF2EADJUSTMONSTERLEVEL.stealth",e.survival="PF2EADJUSTMONSTERLEVEL.survival",e.thievery="PF2EADJUSTMONSTERLEVEL.thievery"}(m||(m={})),function(e){e.d4="d4",e.d6="d6",e.d8="d8",e.d10="d10",e.d12="d12"}(i||(i={})),m.acrobatics,m.arcana,m.athletics,m.crafting,m.deception,m.diplomacy,m.intimidation,m.medicine,m.nature,m.occultism,m.performance,m.religion,m.society,m.stealth,m.survival,m.thievery;const a={[m.hp]:"system.attributes.hp.max",[m.ac]:"system.attributes.ac.value"},o={[m.str]:"system.abilities.str.mod",[m.dex]:"system.abilities.dex.mod",[m.con]:"system.abilities.con.mod",[m.int]:"system.abilities.int.mod",[m.wis]:"system.abilities.wis.mod",[m.cha]:"system.abilities.cha.mod"},h={[m.per]:"system.attributes.perception.value",[m.fort]:"system.saves.fortitude.value",[m.ref]:"system.saves.reflex.value",[m.wil]:"system.saves.will.value"};var l,d;!function(e){e.extreme="PF2EADJUSTMONSTERLEVEL.extreme",e.high="PF2EADJUSTMONSTERLEVEL.high",e.moderate="PF2EADJUSTMONSTERLEVEL.moderate",e.low="PF2EADJUSTMONSTERLEVEL.low",e.terrible="PF2EADJUSTMONSTERLEVEL.terrible",e.none="PF2EADJUSTMONSTERLEVEL.none"}(l||(l={})),function(e){e.minimum="PF2EADJUSTMONSTERLEVEL.minimum",e.maximum="PF2EADJUSTMONSTERLEVEL.maximum"}(d||(d={}));const s={abilityScores:{"-1":{[l.extreme]:"4",[l.high]:"3",[l.moderate]:"2",[l.low]:"0"},0:{[l.extreme]:"4",[l.high]:"3",[l.moderate]:"2",[l.low]:"0"},1:{[l.extreme]:"5",[l.high]:"4",[l.moderate]:"3",[l.low]:"1"},2:{[l.extreme]:"5",[l.high]:"4",[l.moderate]:"3",[l.low]:"1"},3:{[l.extreme]:"5",[l.high]:"4",[l.moderate]:"3",[l.low]:"1"},4:{[l.extreme]:"6",[l.high]:"5",[l.moderate]:"3",[l.low]:"2"},5:{[l.extreme]:"6",[l.high]:"5",[l.moderate]:"4",[l.low]:"2"},6:{[l.extreme]:"7",[l.high]:"5",[l.moderate]:"4",[l.low]:"2"},7:{[l.extreme]:"7",[l.high]:"6",[l.moderate]:"4",[l.low]:"2"},8:{[l.extreme]:"7",[l.high]:"6",[l.moderate]:"4",[l.low]:"3"},9:{[l.extreme]:"7",[l.high]:"6",[l.moderate]:"4",[l.low]:"3"},10:{[l.extreme]:"8",[l.high]:"7",[l.moderate]:"5",[l.low]:"3"},11:{[l.extreme]:"8",[l.high]:"7",[l.moderate]:"5",[l.low]:"3"},12:{[l.extreme]:"8",[l.high]:"7",[l.moderate]:"5",[l.low]:"4"},13:{[l.extreme]:"9",[l.high]:"8",[l.moderate]:"5",[l.low]:"4"},14:{[l.extreme]:"9",[l.high]:"8",[l.moderate]:"5",[l.low]:"4"},15:{[l.extreme]:"9",[l.high]:"8",[l.moderate]:"6",[l.low]:"4"},16:{[l.extreme]:"10",[l.high]:"9",[l.moderate]:"6",[l.low]:"5"},17:{[l.extreme]:"10",[l.high]:"9",[l.moderate]:"6",[l.low]:"4"},18:{[l.extreme]:"10",[l.high]:"9",[l.moderate]:"6",[l.low]:"5"},19:{[l.extreme]:"11",[l.high]:"10",[l.moderate]:"6",[l.low]:"5"},20:{[l.extreme]:"11",[l.high]:"10",[l.moderate]:"7",[l.low]:"6"},21:{[l.extreme]:"11",[l.high]:"10",[l.moderate]:"7",[l.low]:"6"},22:{[l.extreme]:"11",[l.high]:"10",[l.moderate]:"8",[l.low]:"6"},23:{[l.extreme]:"11",[l.high]:"10",[l.moderate]:"8",[l.low]:"6"},24:{[l.extreme]:"13",[l.high]:"12",[l.moderate]:"9",[l.low]:"7"}},hitPoints:{"-1":{[l.high]:"9",[l.moderate]:"7",[l.low]:"5"},0:{[l.high]:"18",[l.moderate]:"15",[l.low]:"12"},1:{[l.high]:"25",[l.moderate]:"20",[l.low]:"15"},2:{[l.high]:"38",[l.moderate]:"30",[l.low]:"23"},3:{[l.high]:"56",[l.moderate]:"45",[l.low]:"34"},4:{[l.high]:"75",[l.moderate]:"60",[l.low]:"45"},5:{[l.high]:"94",[l.moderate]:"75",[l.low]:"56"},6:{[l.high]:"119",[l.moderate]:"95",[l.low]:"71"},7:{[l.high]:"144",[l.moderate]:"115",[l.low]:"86"},8:{[l.high]:"169",[l.moderate]:"135",[l.low]:"101"},9:{[l.high]:"194",[l.moderate]:"155",[l.low]:"116"},10:{[l.high]:"219",[l.moderate]:"175",[l.low]:"131"},11:{[l.high]:"244",[l.moderate]:"195",[l.low]:"146"},12:{[l.high]:"269",[l.moderate]:"215",[l.low]:"161"},13:{[l.high]:"294",[l.moderate]:"235",[l.low]:"176"},14:{[l.high]:"319",[l.moderate]:"255",[l.low]:"191"},15:{[l.high]:"344",[l.moderate]:"275",[l.low]:"206"},16:{[l.high]:"369",[l.moderate]:"295",[l.low]:"221"},17:{[l.high]:"394",[l.moderate]:"315",[l.low]:"236"},18:{[l.high]:"419",[l.moderate]:"335",[l.low]:"251"},19:{[l.high]:"444",[l.moderate]:"355",[l.low]:"266"},20:{[l.high]:"469",[l.moderate]:"375",[l.low]:"281"},21:{[l.high]:"500",[l.moderate]:"400",[l.low]:"300"},22:{[l.high]:"538",[l.moderate]:"430",[l.low]:"323"},23:{[l.high]:"575",[l.moderate]:"460",[l.low]:"345"},24:{[l.high]:"625",[l.moderate]:"500",[l.low]:"375"}},perceptionSaves:{"-1":{[l.extreme]:"9",[l.high]:"8",[l.moderate]:"5",[l.low]:"2",[l.terrible]:"0"},0:{[l.extreme]:"10",[l.high]:"9",[l.moderate]:"6",[l.low]:"3",[l.terrible]:"1"},1:{[l.extreme]:"11",[l.high]:"10",[l.moderate]:"7",[l.low]:"4",[l.terrible]:"2"},2:{[l.extreme]:"12",[l.high]:"11",[l.moderate]:"8",[l.low]:"5",[l.terrible]:"3"},3:{[l.extreme]:"14",[l.high]:"12",[l.moderate]:"9",[l.low]:"6",[l.terrible]:"4"},4:{[l.extreme]:"15",[l.high]:"14",[l.moderate]:"11",[l.low]:"8",[l.terrible]:"6"},5:{[l.extreme]:"17",[l.high]:"15",[l.moderate]:"12",[l.low]:"9",[l.terrible]:"7"},6:{[l.extreme]:"18",[l.high]:"17",[l.moderate]:"14",[l.low]:"11",[l.terrible]:"8"},7:{[l.extreme]:"20",[l.high]:"18",[l.moderate]:"15",[l.low]:"12",[l.terrible]:"10"},8:{[l.extreme]:"21",[l.high]:"19",[l.moderate]:"16",[l.low]:"13",[l.terrible]:"11"},9:{[l.extreme]:"23",[l.high]:"21",[l.moderate]:"18",[l.low]:"15",[l.terrible]:"12"},10:{[l.extreme]:"24",[l.high]:"22",[l.moderate]:"19",[l.low]:"16",[l.terrible]:"14"},11:{[l.extreme]:"26",[l.high]:"24",[l.moderate]:"21",[l.low]:"18",[l.terrible]:"15"},12:{[l.extreme]:"27",[l.high]:"25",[l.moderate]:"22",[l.low]:"19",[l.terrible]:"16"},13:{[l.extreme]:"29",[l.high]:"26",[l.moderate]:"23",[l.low]:"20",[l.terrible]:"18"},14:{[l.extreme]:"30",[l.high]:"28",[l.moderate]:"25",[l.low]:"22",[l.terrible]:"19"},15:{[l.extreme]:"32",[l.high]:"29",[l.moderate]:"26",[l.low]:"23",[l.terrible]:"20"},16:{[l.extreme]:"33",[l.high]:"30",[l.moderate]:"28",[l.low]:"25",[l.terrible]:"22"},17:{[l.extreme]:"35",[l.high]:"32",[l.moderate]:"29",[l.low]:"26",[l.terrible]:"23"},18:{[l.extreme]:"36",[l.high]:"33",[l.moderate]:"30",[l.low]:"27",[l.terrible]:"24"},19:{[l.extreme]:"38",[l.high]:"35",[l.moderate]:"32",[l.low]:"29",[l.terrible]:"26"},20:{[l.extreme]:"39",[l.high]:"36",[l.moderate]:"33",[l.low]:"30",[l.terrible]:"27"},21:{[l.extreme]:"41",[l.high]:"38",[l.moderate]:"35",[l.low]:"32",[l.terrible]:"28"},22:{[l.extreme]:"43",[l.high]:"39",[l.moderate]:"36",[l.low]:"33",[l.terrible]:"30"},23:{[l.extreme]:"44",[l.high]:"40",[l.moderate]:"37",[l.low]:"34",[l.terrible]:"31"},24:{[l.extreme]:"46",[l.high]:"42",[l.moderate]:"38",[l.low]:"36",[l.terrible]:"32"}},armorClass:{"-1":{[l.extreme]:"18",[l.high]:"15",[l.moderate]:"14",[l.low]:"12"},0:{[l.extreme]:"19",[l.high]:"16",[l.moderate]:"15",[l.low]:"13"},1:{[l.extreme]:"19",[l.high]:"16",[l.moderate]:"15",[l.low]:"13"},2:{[l.extreme]:"21",[l.high]:"18",[l.moderate]:"17",[l.low]:"15"},3:{[l.extreme]:"22",[l.high]:"19",[l.moderate]:"18",[l.low]:"16"},4:{[l.extreme]:"24",[l.high]:"21",[l.moderate]:"20",[l.low]:"18"},5:{[l.extreme]:"25",[l.high]:"22",[l.moderate]:"21",[l.low]:"19"},6:{[l.extreme]:"27",[l.high]:"24",[l.moderate]:"23",[l.low]:"21"},7:{[l.extreme]:"28",[l.high]:"25",[l.moderate]:"24",[l.low]:"22"},8:{[l.extreme]:"30",[l.high]:"27",[l.moderate]:"26",[l.low]:"24"},9:{[l.extreme]:"31",[l.high]:"28",[l.moderate]:"27",[l.low]:"25"},10:{[l.extreme]:"33",[l.high]:"30",[l.moderate]:"29",[l.low]:"27"},11:{[l.extreme]:"34",[l.high]:"31",[l.moderate]:"30",[l.low]:"28"},12:{[l.extreme]:"36",[l.high]:"33",[l.moderate]:"32",[l.low]:"30"},13:{[l.extreme]:"37",[l.high]:"34",[l.moderate]:"33",[l.low]:"31"},14:{[l.extreme]:"39",[l.high]:"36",[l.moderate]:"35",[l.low]:"33"},15:{[l.extreme]:"40",[l.high]:"37",[l.moderate]:"36",[l.low]:"34"},16:{[l.extreme]:"42",[l.high]:"39",[l.moderate]:"38",[l.low]:"36"},17:{[l.extreme]:"43",[l.high]:"40",[l.moderate]:"39",[l.low]:"37"},18:{[l.extreme]:"45",[l.high]:"42",[l.moderate]:"41",[l.low]:"39"},19:{[l.extreme]:"46",[l.high]:"43",[l.moderate]:"42",[l.low]:"40"},20:{[l.extreme]:"48",[l.high]:"45",[l.moderate]:"44",[l.low]:"42"},21:{[l.extreme]:"49",[l.high]:"46",[l.moderate]:"45",[l.low]:"43"},22:{[l.extreme]:"51",[l.high]:"48",[l.moderate]:"47",[l.low]:"45"},23:{[l.extreme]:"52",[l.high]:"49",[l.moderate]:"48",[l.low]:"46"},24:{[l.extreme]:"54",[l.high]:"51",[l.moderate]:"50",[l.low]:"48"}},strikeBonus:{"-1":{[l.extreme]:"10",[l.high]:"8",[l.moderate]:"6",[l.low]:"4"},0:{[l.extreme]:"10",[l.high]:"8",[l.moderate]:"6",[l.low]:"4"},1:{[l.extreme]:"11",[l.high]:"9",[l.moderate]:"7",[l.low]:"5"},2:{[l.extreme]:"13",[l.high]:"11",[l.moderate]:"9",[l.low]:"7"},3:{[l.extreme]:"14",[l.high]:"12",[l.moderate]:"10",[l.low]:"8"},4:{[l.extreme]:"16",[l.high]:"14",[l.moderate]:"12",[l.low]:"9"},5:{[l.extreme]:"17",[l.high]:"15",[l.moderate]:"13",[l.low]:"11"},6:{[l.extreme]:"19",[l.high]:"17",[l.moderate]:"15",[l.low]:"12"},7:{[l.extreme]:"20",[l.high]:"18",[l.moderate]:"16",[l.low]:"13"},8:{[l.extreme]:"22",[l.high]:"20",[l.moderate]:"18",[l.low]:"15"},9:{[l.extreme]:"23",[l.high]:"21",[l.moderate]:"19",[l.low]:"16"},10:{[l.extreme]:"25",[l.high]:"23",[l.moderate]:"21",[l.low]:"17"},11:{[l.extreme]:"27",[l.high]:"24",[l.moderate]:"22",[l.low]:"19"},12:{[l.extreme]:"28",[l.high]:"26",[l.moderate]:"24",[l.low]:"20"},13:{[l.extreme]:"29",[l.high]:"27",[l.moderate]:"25",[l.low]:"21"},14:{[l.extreme]:"31",[l.high]:"29",[l.moderate]:"27",[l.low]:"23"},15:{[l.extreme]:"32",[l.high]:"30",[l.moderate]:"28",[l.low]:"24"},16:{[l.extreme]:"34",[l.high]:"32",[l.moderate]:"30",[l.low]:"25"},17:{[l.extreme]:"35",[l.high]:"33",[l.moderate]:"31",[l.low]:"27"},18:{[l.extreme]:"37",[l.high]:"35",[l.moderate]:"33",[l.low]:"28"},19:{[l.extreme]:"38",[l.high]:"36",[l.moderate]:"34",[l.low]:"29"},20:{[l.extreme]:"40",[l.high]:"38",[l.moderate]:"36",[l.low]:"31"},21:{[l.extreme]:"41",[l.high]:"39",[l.moderate]:"37",[l.low]:"32"},22:{[l.extreme]:"43",[l.high]:"41",[l.moderate]:"39",[l.low]:"33"},23:{[l.extreme]:"44",[l.high]:"42",[l.moderate]:"40",[l.low]:"35"},24:{[l.extreme]:"46",[l.high]:"44",[l.moderate]:"42",[l.low]:"36"}},strikeDamage:{"-1":{[l.extreme]:"4",[l.high]:"3",[l.moderate]:"3",[l.low]:"2"},0:{[l.extreme]:"6",[l.high]:"5",[l.moderate]:"4",[l.low]:"3"},1:{[l.extreme]:"8",[l.high]:"6",[l.moderate]:"5",[l.low]:"4"},2:{[l.extreme]:"11",[l.high]:"9",[l.moderate]:"8",[l.low]:"6"},3:{[l.extreme]:"15",[l.high]:"12",[l.moderate]:"10",[l.low]:"8"},4:{[l.extreme]:"18",[l.high]:"14",[l.moderate]:"12",[l.low]:"9"},5:{[l.extreme]:"20",[l.high]:"16",[l.moderate]:"13",[l.low]:"11"},6:{[l.extreme]:"23",[l.high]:"18",[l.moderate]:"15",[l.low]:"12"},7:{[l.extreme]:"25",[l.high]:"20",[l.moderate]:"17",[l.low]:"13"},8:{[l.extreme]:"28",[l.high]:"22",[l.moderate]:"18",[l.low]:"15"},9:{[l.extreme]:"30",[l.high]:"24",[l.moderate]:"20",[l.low]:"16"},10:{[l.extreme]:"33",[l.high]:"26",[l.moderate]:"22",[l.low]:"17"},11:{[l.extreme]:"35",[l.high]:"28",[l.moderate]:"23",[l.low]:"19"},12:{[l.extreme]:"38",[l.high]:"30",[l.moderate]:"25",[l.low]:"20"},13:{[l.extreme]:"40",[l.high]:"32",[l.moderate]:"27",[l.low]:"21"},14:{[l.extreme]:"43",[l.high]:"34",[l.moderate]:"28",[l.low]:"23"},15:{[l.extreme]:"45",[l.high]:"36",[l.moderate]:"30",[l.low]:"24"},16:{[l.extreme]:"48",[l.high]:"37",[l.moderate]:"31",[l.low]:"25"},17:{[l.extreme]:"50",[l.high]:"38",[l.moderate]:"32",[l.low]:"26"},18:{[l.extreme]:"53",[l.high]:"40",[l.moderate]:"33",[l.low]:"27"},19:{[l.extreme]:"55",[l.high]:"42",[l.moderate]:"35",[l.low]:"28"},20:{[l.extreme]:"58",[l.high]:"44",[l.moderate]:"37",[l.low]:"29"},21:{[l.extreme]:"60",[l.high]:"46",[l.moderate]:"38",[l.low]:"31"},22:{[l.extreme]:"63",[l.high]:"48",[l.moderate]:"40",[l.low]:"32"},23:{[l.extreme]:"65",[l.high]:"50",[l.moderate]:"42",[l.low]:"33"},24:{[l.extreme]:"68",[l.high]:"52",[l.moderate]:"44",[l.low]:"35"}},strikeDamageRoll:{"-1":{[l.extreme]:"1d6+1",[l.high]:"1d4+1",[l.moderate]:"1d4",[l.low]:"1d4"},0:{[l.extreme]:"1d6+3",[l.high]:"1d6+2",[l.moderate]:"1d4+2",[l.low]:"1d4+1"},1:{[l.extreme]:"1d8+4",[l.high]:"1d6+3",[l.moderate]:"1d6+2",[l.low]:"1d4+2"},2:{[l.extreme]:"1d12+4",[l.high]:"1d10+4",[l.moderate]:"1d8+4",[l.low]:"1d6+3"},3:{[l.extreme]:"1d12+8",[l.high]:"1d10+6",[l.moderate]:"1d8+6",[l.low]:"1d6+5"},4:{[l.extreme]:"2d10+7",[l.high]:"2d8+5",[l.moderate]:"2d6+5",[l.low]:"2d4+4"},5:{[l.extreme]:"2d12+7",[l.high]:"2d8+7",[l.moderate]:"2d6+6",[l.low]:"2d4+6"},6:{[l.extreme]:"2d12+10",[l.high]:"2d8+9",[l.moderate]:"2d6+8",[l.low]:"2d4+7"},7:{[l.extreme]:"2d12+12",[l.high]:"2d10+9",[l.moderate]:"2d8+8",[l.low]:"2d6+6"},8:{[l.extreme]:"2d12+15",[l.high]:"2d10+11",[l.moderate]:"2d8+9",[l.low]:"2d6+8"},9:{[l.extreme]:"2d12+17",[l.high]:"2d10+13",[l.moderate]:"2d8+11",[l.low]:"2d6+9"},10:{[l.extreme]:"2d12+20",[l.high]:"2d12+13",[l.moderate]:"2d10+11",[l.low]:"2d6+10"},11:{[l.extreme]:"2d12+22",[l.high]:"2d12+15",[l.moderate]:"2d10+12",[l.low]:"2d8+10"},12:{[l.extreme]:"3d12+19",[l.high]:"3d10+14",[l.moderate]:"3d8+12",[l.low]:"3d6+10"},13:{[l.extreme]:"3d12+21",[l.high]:"3d10+16",[l.moderate]:"3d8+14",[l.low]:"3d6+11"},14:{[l.extreme]:"3d12+24",[l.high]:"3d10+18",[l.moderate]:"3d8+15",[l.low]:"3d6+13"},15:{[l.extreme]:"3d12+26",[l.high]:"3d12+17",[l.moderate]:"3d10+14",[l.low]:"3d6+14"},16:{[l.extreme]:"3d12+29",[l.high]:"3d12+18",[l.moderate]:"3d10+15",[l.low]:"3d6+15"},17:{[l.extreme]:"3d12+31",[l.high]:"3d12+19",[l.moderate]:"3d10+16",[l.low]:"3d6+16"},18:{[l.extreme]:"3d12+34",[l.high]:"3d12+20",[l.moderate]:"3d10+17",[l.low]:"3d6+17"},19:{[l.extreme]:"4d12+29",[l.high]:"4d10+20",[l.moderate]:"4d8+17",[l.low]:"4d6+14"},20:{[l.extreme]:"4d12+32",[l.high]:"4d10+22",[l.moderate]:"4d8+19",[l.low]:"4d6+15"},21:{[l.extreme]:"4d12+34",[l.high]:"4d10+24",[l.moderate]:"4d8+20",[l.low]:"4d6+17"},22:{[l.extreme]:"4d12+37",[l.high]:"4d10+26",[l.moderate]:"4d8+22",[l.low]:"4d6+18"},23:{[l.extreme]:"4d12+39",[l.high]:"4d12+24",[l.moderate]:"4d10+20",[l.low]:"4d6+19"},24:{[l.extreme]:"4d12+42",[l.high]:"4d12+26",[l.moderate]:"4d10+22",[l.low]:"4d6+21"}},spellcasting:{"-1":{[l.extreme]:"11",[l.high]:"8",[l.moderate]:"5"},0:{[l.extreme]:"11",[l.high]:"8",[l.moderate]:"5"},1:{[l.extreme]:"12",[l.high]:"9",[l.moderate]:"6"},2:{[l.extreme]:"14",[l.high]:"10",[l.moderate]:"7"},3:{[l.extreme]:"15",[l.high]:"12",[l.moderate]:"9"},4:{[l.extreme]:"17",[l.high]:"13",[l.moderate]:"10"},5:{[l.extreme]:"18",[l.high]:"14",[l.moderate]:"11"},6:{[l.extreme]:"19",[l.high]:"16",[l.moderate]:"13"},7:{[l.extreme]:"21",[l.high]:"17",[l.moderate]:"14"},8:{[l.extreme]:"22",[l.high]:"18",[l.moderate]:"15"},9:{[l.extreme]:"24",[l.high]:"20",[l.moderate]:"17"},10:{[l.extreme]:"25",[l.high]:"21",[l.moderate]:"18"},11:{[l.extreme]:"26",[l.high]:"22",[l.moderate]:"19"},12:{[l.extreme]:"28",[l.high]:"24",[l.moderate]:"21"},13:{[l.extreme]:"29",[l.high]:"25",[l.moderate]:"22"},14:{[l.extreme]:"31",[l.high]:"26",[l.moderate]:"23"},15:{[l.extreme]:"32",[l.high]:"28",[l.moderate]:"25"},16:{[l.extreme]:"33",[l.high]:"29",[l.moderate]:"26"},17:{[l.extreme]:"35",[l.high]:"30",[l.moderate]:"27"},18:{[l.extreme]:"36",[l.high]:"32",[l.moderate]:"29"},19:{[l.extreme]:"38",[l.high]:"33",[l.moderate]:"30"},20:{[l.extreme]:"39",[l.high]:"34",[l.moderate]:"31"},21:{[l.extreme]:"40",[l.high]:"36",[l.moderate]:"33"},22:{[l.extreme]:"42",[l.high]:"37",[l.moderate]:"34"},23:{[l.extreme]:"43",[l.high]:"38",[l.moderate]:"35"},24:{[l.extreme]:"44",[l.high]:"40",[l.moderate]:"37"}},spellDC:{"-1":{[l.extreme]:"19",[l.high]:"16",[l.moderate]:"13"},0:{[l.extreme]:"19",[l.high]:"16",[l.moderate]:"13"},1:{[l.extreme]:"20",[l.high]:"17",[l.moderate]:"14"},2:{[l.extreme]:"22",[l.high]:"18",[l.moderate]:"15"},3:{[l.extreme]:"23",[l.high]:"20",[l.moderate]:"17"},4:{[l.extreme]:"25",[l.high]:"21",[l.moderate]:"18"},5:{[l.extreme]:"26",[l.high]:"22",[l.moderate]:"19"},6:{[l.extreme]:"27",[l.high]:"24",[l.moderate]:"21"},7:{[l.extreme]:"29",[l.high]:"25",[l.moderate]:"22"},8:{[l.extreme]:"30",[l.high]:"26",[l.moderate]:"23"},9:{[l.extreme]:"32",[l.high]:"28",[l.moderate]:"25"},10:{[l.extreme]:"33",[l.high]:"29",[l.moderate]:"26"},11:{[l.extreme]:"34",[l.high]:"30",[l.moderate]:"27"},12:{[l.extreme]:"36",[l.high]:"32",[l.moderate]:"29"},13:{[l.extreme]:"37",[l.high]:"33",[l.moderate]:"30"},14:{[l.extreme]:"39",[l.high]:"34",[l.moderate]:"31"},15:{[l.extreme]:"40",[l.high]:"36",[l.moderate]:"33"},16:{[l.extreme]:"41",[l.high]:"37",[l.moderate]:"34"},17:{[l.extreme]:"43",[l.high]:"38",[l.moderate]:"35"},18:{[l.extreme]:"44",[l.high]:"40",[l.moderate]:"37"},19:{[l.extreme]:"46",[l.high]:"41",[l.moderate]:"38"},20:{[l.extreme]:"47",[l.high]:"42",[l.moderate]:"39"},21:{[l.extreme]:"48",[l.high]:"44",[l.moderate]:"41"},22:{[l.extreme]:"50",[l.high]:"45",[l.moderate]:"42"},23:{[l.extreme]:"51",[l.high]:"46",[l.moderate]:"43"},24:{[l.extreme]:"52",[l.high]:"48",[l.moderate]:"45"}},skills:{"-1":{[l.extreme]:"8",[l.high]:"5",[l.moderate]:"4",[l.low]:"2"},0:{[l.extreme]:"9",[l.high]:"6",[l.moderate]:"5",[l.low]:"3"},1:{[l.extreme]:"10",[l.high]:"7",[l.moderate]:"6",[l.low]:"4"},2:{[l.extreme]:"11",[l.high]:"8",[l.moderate]:"7",[l.low]:"5"},3:{[l.extreme]:"13",[l.high]:"10",[l.moderate]:"9",[l.low]:"6"},4:{[l.extreme]:"15",[l.high]:"12",[l.moderate]:"10",[l.low]:"8"},5:{[l.extreme]:"16",[l.high]:"13",[l.moderate]:"12",[l.low]:"9"},6:{[l.extreme]:"18",[l.high]:"15",[l.moderate]:"13",[l.low]:"10"},7:{[l.extreme]:"20",[l.high]:"17",[l.moderate]:"15",[l.low]:"12"},8:{[l.extreme]:"21",[l.high]:"18",[l.moderate]:"16",[l.low]:"13"},9:{[l.extreme]:"23",[l.high]:"20",[l.moderate]:"18",[l.low]:"14"},10:{[l.extreme]:"25",[l.high]:"22",[l.moderate]:"19",[l.low]:"16"},11:{[l.extreme]:"26",[l.high]:"23",[l.moderate]:"21",[l.low]:"18"},12:{[l.extreme]:"28",[l.high]:"25",[l.moderate]:"22",[l.low]:"19"},13:{[l.extreme]:"30",[l.high]:"27",[l.moderate]:"24",[l.low]:"21"},14:{[l.extreme]:"31",[l.high]:"28",[l.moderate]:"25",[l.low]:"22"},15:{[l.extreme]:"33",[l.high]:"30",[l.moderate]:"27",[l.low]:"23"},16:{[l.extreme]:"35",[l.high]:"32",[l.moderate]:"28",[l.low]:"25"},17:{[l.extreme]:"36",[l.high]:"33",[l.moderate]:"30",[l.low]:"26"},18:{[l.extreme]:"38",[l.high]:"35",[l.moderate]:"31",[l.low]:"28"},19:{[l.extreme]:"40",[l.high]:"37",[l.moderate]:"33",[l.low]:"29"},20:{[l.extreme]:"41",[l.high]:"38",[l.moderate]:"34",[l.low]:"30"},21:{[l.extreme]:"43",[l.high]:"40",[l.moderate]:"36",[l.low]:"31"},22:{[l.extreme]:"45",[l.high]:"42",[l.moderate]:"37",[l.low]:"32"},23:{[l.extreme]:"46",[l.high]:"43",[l.moderate]:"38",[l.low]:"34"},24:{[l.extreme]:"48",[l.high]:"45",[l.moderate]:"40",[l.low]:"36"}},resistWeak:{"-1":{[d.minimum]:"1",[d.maximum]:"1"},0:{[d.minimum]:"1",[d.maximum]:"3"},1:{[d.minimum]:"2",[d.maximum]:"3"},2:{[d.minimum]:"2",[d.maximum]:"5"},3:{[d.minimum]:"3",[d.maximum]:"6"},4:{[d.minimum]:"4",[d.maximum]:"7"},5:{[d.minimum]:"4",[d.maximum]:"8"},6:{[d.minimum]:"5",[d.maximum]:"9"},7:{[d.minimum]:"5",[d.maximum]:"10"},8:{[d.minimum]:"6",[d.maximum]:"11"},9:{[d.minimum]:"6",[d.maximum]:"12"},10:{[d.minimum]:"7",[d.maximum]:"13"},11:{[d.minimum]:"7",[d.maximum]:"14"},12:{[d.minimum]:"8",[d.maximum]:"15"},13:{[d.minimum]:"8",[d.maximum]:"16"},14:{[d.minimum]:"9",[d.maximum]:"17"},15:{[d.minimum]:"9",[d.maximum]:"18"},16:{[d.minimum]:"9",[d.maximum]:"19"},17:{[d.minimum]:"10",[d.maximum]:"19"},18:{[d.minimum]:"10",[d.maximum]:"20"},19:{[d.minimum]:"11",[d.maximum]:"21"},20:{[d.minimum]:"11",[d.maximum]:"22"},21:{[d.minimum]:"12",[d.maximum]:"23"},22:{[d.minimum]:"12",[d.maximum]:"24"},23:{[d.minimum]:"13",[d.maximum]:"25"},24:{[d.minimum]:"13",[d.maximum]:"26"}}},g={[m.str]:s.abilityScores,[m.dex]:s.abilityScores,[m.con]:s.abilityScores,[m.int]:s.abilityScores,[m.wis]:s.abilityScores,[m.cha]:s.abilityScores,[m.hp]:s.hitPoints,[m.per]:s.perceptionSaves,[m.ac]:s.armorClass,[m.resistWeak]:s.resistWeak,[m.fort]:s.perceptionSaves,[m.ref]:s.perceptionSaves,[m.wil]:s.perceptionSaves,[m.strikeBonus]:s.strikeBonus,[m.strikeDamage]:s.strikeDamage,[m.spellcasting]:s.spellcasting,[m.spellDC]:s.spellDC,[m.acrobatics]:s.skills,[m.arcana]:s.skills,[m.athletics]:s.skills,[m.crafting]:s.skills,[m.deception]:s.skills,[m.diplomacy]:s.skills,[m.intimidation]:s.skills,[m.medicine]:s.skills,[m.nature]:s.skills,[m.occultism]:s.skills,[m.performance]:s.skills,[m.religion]:s.skills,[m.society]:s.skills,[m.stealth]:s.skills,[m.survival]:s.skills,[m.thievery]:s.skills},n={[i.d4]:2.5,[i.d6]:3.5,[i.d8]:4.5,[i.d10]:5.5,[i.d12]:6.5};class u{constructor(e){this.adjustments=[],this.displayName=e}}class x extends FormApplication{constructor(){super(...arguments),this.actor=this.object,this.level="-1",this.DataToModify=[],this.arrayLikePattern=/\[(\d+)\]/}static get defaultOptions(){return mergeObject(super.defaultOptions,{classes:["form"],popOut:!0,template:"modules/pf2e-adjust-monster-level/forms/adjustMonsterLevelForm.html",id:"adjustMonsterLevelForm",title:"Adjust Level Form",height:833,width:400})}async _updateObject(r,i){if(i){let r=this.actor.system.details.level.value;this.level=i[m.level];let a=[],o={targetDocument:this.actor,data:{name:i[m.name]?i[m.name]:this.actor.name,"system.details.level.value":parseInt(this.level)}};a.push(o);for(const e of this.DataToModify)for(const t of e.adjustments)if("function"==typeof t.targetDocument.update){let e=a.find((e=>e.targetDocument==t.targetDocument));e||(e={targetDocument:t.targetDocument,data:{}},a.push(e));let i=t.targetAttribute.match(this.arrayLikePattern);i?this.mergeIndexedAdjustment(e,t,i[0]):t.statistic==m.strikeDamage?this.mergeStrikeDamage(e,t,this.level>r):this.mergeSimpleAdjustment(e,t)}if(game.settings.get(e,t)){console.log(`----- Data deltas for adjusting monster ${this.actor.name} ${this.actor.system.details.level.value}->${this.level} -----`);for(const e of a)console.log(`${e.targetDocument.name}`),console.log(e.data)}else{for(const e of a)await e.targetDocument.update(e.data);await this.actor.update(this.updateHitPoints())}}}mergeStrikeDamage(e,t,r){let m=g[t.statistic][this.level],i=x.getNumericValue(t.normalizedValue,m),a={},o=x.getChildField(t.targetDocument,t.targetAttribute);for(let[e,m]of Object.entries(o)){m.damage;let o=t.metaData[e],h=o.totalFraction*i,l="";if(o.flatFraction>0){let e=Math.round(h*o.flatFraction);l+=`+${e}`,h-=e}l=x.getClosestDieRoll(h,o.dieSize,r)+l,a[`${t.targetAttribute}.${e}.damage`]=l}e.data=mergeObject(e.data,a)}mergeSimpleAdjustment(e,t){let r=g[t.statistic][this.level],m={[t.targetAttribute]:x.getNumericValue(t.normalizedValue,r)};e.data=mergeObject(e.data,m)}mergeIndexedAdjustment(e,t,r){let m=g[t.statistic][this.level],i=t.targetAttribute.indexOf(r),a=t.targetAttribute.substring(i+r.length+1);t.targetAttribute=t.targetAttribute.substring(0,i);let o=parseInt(r.substring(1,r.length-1)),h=x.getChildField(e.data,t.targetAttribute);if(!h){let e=x.getChildField(t.targetDocument,t.targetAttribute);h=JSON.parse(JSON.stringify(e))}h[o][a]=x.getNumericValue(t.normalizedValue,m);let l={[t.targetAttribute]:h};e.data=mergeObject(e.data,l)}static getClosestDieRoll(e,t,r){let m=[i.d4,i.d6,i.d8,i.d10,i.d12];const a=m.indexOf(t);r&&a>0?m.splice(0,a):!r&&a<m.length-1&&m.splice(m.indexOf(t)+1);let o=Math.round(e/n[t]),h=t,l=Math.abs(o*n[t]-e);for(const t of m){const r=n[t];let m=Math.round(e/r),i=Math.abs(m*r-e);i<l&&(o=m,h=t,l=i)}return`${o}${h}`}static getNumericValue(e,t){let r=[d.minimum,d.maximum,l.terrible,l.low,l.moderate,l.high,l.extreme];r=r.filter((e=>e in t));for(let m=0;m<r.length-1;m++){if(e<m+1&&0!=m)continue;if(e>m+2&&m!=r.length-1)continue;const i=e-(m+1);let a=parseInt(t[r[m]]),o=parseInt(t[r[m+1]]);return Math.round(i*(o-a)+a)}return 0}updateHitPoints(){return{"system.attributes.hp.value":this.actor.system.attributes.hp.max}}getData(){this.level=this.actor.system.details.level.value.toString();const e={[m.name]:this.actor.name,[m.level]:this.level};this.pushActorCategory("Defenses",a),this.pushActorCategory("AbilityModifiers",o),this.pushActorCategory("PerceptionAndSaves",h);let t=this.actor;if(t.system.attributes.weaknesses.length>0){let e=new u(x.localize("PF2EADJUSTMONSTERLEVEL.categoryWeaknesses"));for(let r=0;r<t.system.attributes.weaknesses.length;r++){const m=t.system.attributes.weaknesses[r];let i=this.getResistWeakAdjustment(m,`system.attributes.weaknesses[${r}].value`);e.adjustments.push(i)}this.DataToModify.push(e)}if(t.system.attributes.resistances.length>0){let e=new u(x.localize("PF2EADJUSTMONSTERLEVEL.categoryWeaknesses"));for(let r=0;r<t.system.attributes.resistances.length;r++){const m=t.system.attributes.resistances[r];let i=this.getResistWeakAdjustment(m,`system.attributes.resistances[${r}].value`);e.adjustments.push(i)}this.DataToModify.push(e)}let i=new u(x.localize("PF2EADJUSTMONSTERLEVEL.categorySkills"));this.DataToModify.push(i);for(const[,e]of this.actor.items.entries())if("lore"==e.type&&null!=e.name){let t="PF2EADJUSTMONSTERLEVEL."+e.name.toLowerCase(),r=this.getItemAdjustment(t,e,"system.mod.value");r&&i.adjustments.push(r)}else if("spellcastingEntry"==e.type&&null!=e.name){let t=this.getItemAdjustment(m.spellcasting,e,"system.spelldc.value");if(t){let r=JSON.parse(JSON.stringify(t));r.targetAttribute="system.spelldc.dc";let m=new u(e.name);m.adjustments.push(t),m.adjustments.push(r),this.DataToModify.push(m)}}else if("melee"==e.type&&null!=e.name){let t=this.getItemAdjustment(m.strikeBonus,e,"system.bonus.value"),r=this.getItemAdjustment(m.strikeDamage,e,"system.damageRolls"),i=new u(e.name+" Strike");t&&i.adjustments.push(t),r&&i.adjustments.push(r),i.adjustments.length>0&&this.DataToModify.push(i)}return Handlebars.registerHelper("json",(function(e){return JSON.stringify(e)})),{Levels:r,Current:e,ToModify:JSON.parse(JSON.stringify(this.DataToModify))}}pushActorCategory(e,t){let r=new u(x.localize(`PF2EADJUSTMONSTERLEVEL.category${e}`));for(const[e,m]of Object.entries(t)){let t=this.getActorFieldAdjustment(e,m);t&&r.adjustments.push(t)}this.DataToModify.push(r)}getActorFieldAdjustment(e,t){const r=g[e][this.level];let m=x.getChildField(this.actor,t),i=x.getNormalizedValue(m,r,1);return i.value>-9999?{targetDocument:this.actor,targetAttribute:t,normalizedValue:i.value,displayValue:i.display,statistic:e}:null}getResistWeakAdjustment(e,t){const r=g[m.resistWeak][this.level];let i=e.value,a=x.getNormalizedValue(i,r,1);return{targetDocument:this.actor,targetAttribute:t,statistic:m.resistWeak,normalizedValue:a.value,displayValue:a.display,displayName:e.type}}getItemAdjustment(e,t,r){const i=g[e][this.level];let a=null,o=0;if("lore"==t.type||"spellcastingEntry"==t.type||"melee"==t.type&&e==m.strikeBonus)o=x.getChildField(t,r);else{if("melee"!=t.type||e!=m.strikeDamage)return null;{let e=0;a={};for(let[r,m]of Object.entries(t.system.damageRolls)){let t=x.getDamageRollValues(m.damage);e+=t.total,a[r]={totalFraction:t.total,flatFraction:t.flatFraction,dieSize:t.dieSize}}o=Math.ceil(e);for(const[,e]of Object.entries(a))e.totalFraction=e.totalFraction/o}}let h=x.getNormalizedValue(o,i,1);return h.value>-9999?{targetDocument:t,targetAttribute:r,statistic:e,normalizedValue:h.value,displayValue:h.display,metaData:a}:null}static localize(e){return game.i18n.localize(e)}static getNormalizedValue(e,t,r=-9999){let m=[d.minimum,d.maximum,l.terrible,l.low,l.moderate,l.high,l.extreme];if(m=m.filter((e=>e in t)),-9999===r&&(r=parseInt(t[m[0]])),e<r)return{value:-9999,display:""};for(let r=0;r<m.length-1;r++){const i=parseInt(t[m[r]]),a=parseInt(t[m[r+1]]);if(e>=i&&e<a||0==r&&e<i||r==m.length-2&&e>=a){let t=(e-i)/(a-i);t=Math.round(10*t)/10;let o=x.localize(m[r]);return 0!=t&&1!=t&&(t>0&&(o+="+"),o+=t.toFixed(1)),(t<0||t>1)&&(o+=" ⚠️"),{value:t+r+1,display:o}}}return{value:-9999,display:""}}static getDamageRollValues(e){let t=0,r=0;const m=e.indexOf("+");m>=0&&(r=parseInt(e.substring(m+1)),t+=r,e=e.substring(0,m));const i=(e=e.trim()).indexOf("d");let a="";if(i>=0){let r=e.substring(0,i);a=e.substring(i),t+=parseInt(r)*n[a]}return{total:t,dieSize:a,flatFraction:r/t}}static getChildField(e,t){let r=e,m=t.split(".");for(;m.length>0;)r=r[m[0]],m.splice(0,1);return r}}Hooks.on("init",(async function(){await game.settings.register(e,"expandFoldout",{scope:"client",config:!1,requiresReload:!1,type:Boolean,default:!1}),await game.settings.register(e,t,{name:"PF2EADJUSTMONSTERLEVEL.SETTINGS.testModeLabel",hint:"PF2EADJUSTMONSTERLEVEL.SETTINGS.testModeHint",scope:"client",config:!0,requiresReload:!1,type:Boolean,default:!1})})),Hooks.on("renderActorSheet",(async function(e,t){let r=e.object;if("npc"!==r?.type)return;if(!r.canUserModify(game.user,"update"))return;let m=t.find(".adjustment-select"),i=$(`<a class="adjustment trait" style>${x.localize("PF2EADJUSTMONSTERLEVEL.ACTORSHEET.buttonlabel")}</a>`);i.on("click",(()=>{new x(r).render(!0)})),m.after(i)}))})();